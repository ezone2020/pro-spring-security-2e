(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73032f06"],{"066d":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-drawer",{attrs:{title:"评论列表",width:t.isMobile()?"100%":"480",closable:"",visible:t.visible,destroyOnClose:"",afterVisibleChange:t.handleAfterVisibleChanged},on:{close:t.onClose}},[n("a-row",{attrs:{type:"flex",align:"middle"}},[n("a-col",{attrs:{span:24}},[n("a-list",{attrs:{itemLayout:"horizontal"}},[n("a-list-item",[n("a-list-item-meta",[n("template",{slot:"description"},[n("p",{staticClass:"comment-drawer-content",domProps:{innerHTML:t._s(t.description)}})]),n("h3",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.title))])],2)],1)],1)],1),n("a-divider"),n("a-col",{attrs:{span:24}},[n("a-spin",{attrs:{spinning:t.loading}},[0==t.comments.length?n("a-empty"):t._l(t.comments,(function(e,a){return n("TargetCommentTree",{key:a,attrs:{comment:e},on:{reply:t.handleCommentReply,delete:t.handleCommentDelete,editStatus:t.handleEditStatusClick}})}))],2)],1)],1),n("a-divider"),n("div",{staticClass:"page-wrapper"},[n("a-pagination",{attrs:{current:t.pagination.page,total:t.pagination.total,defaultPageSize:t.pagination.size,showLessItems:""},on:{change:t.handlePaginationChange}})],1),n("a-divider",{staticClass:"divider-transparent"}),n("div",{staticClass:"bottom-control"},[n("a-button",{attrs:{type:"primary"},on:{click:t.handleComment}},[t._v("评论")])],1),t.selectedComment?n("a-modal",{attrs:{title:"回复给："+t.selectedComment.author,destroyOnClose:""},on:{close:t.onReplyClose},model:{value:t.replyCommentVisible,callback:function(e){t.replyCommentVisible=e},expression:"replyCommentVisible"}},[n("template",{slot:"footer"},[n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.handleCreateClick}},[t._v(" 回复 ")])],1),n("a-form",{attrs:{layout:"vertical"}},[n("a-form-item",[n("a-input",{attrs:{type:"textarea",autoSize:{minRows:8}},model:{value:t.replyComment.content,callback:function(e){t.$set(t.replyComment,"content",e)},expression:"replyComment.content"}})],1)],1)],2):t._e(),n("a-modal",{attrs:{title:"评论",destroyOnClose:""},on:{close:t.onCommentClose},model:{value:t.commentVisible,callback:function(e){t.commentVisible=e},expression:"commentVisible"}},[n("template",{slot:"footer"},[n("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.handleCreateClick}},[t._v(" 回复 ")])],1),n("a-form",{attrs:{layout:"vertical"}},[n("a-form-item",[n("a-input",{attrs:{type:"textarea",autoSize:{minRows:8}},model:{value:t.replyComment.content,callback:function(e){t.$set(t.replyComment,"content",e)},expression:"replyComment.content"}})],1)],1)],2)],1)},i=[],s=(n("55dd"),n("c5f6"),n("ac0d")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-comment",[n("template",{slot:"actions"},["AUDITING"===t.comment.status?n("a-dropdown",{attrs:{trigger:["click"]}},[n("span",{attrs:{href:"javascript:void(0);"}},[t._v("通过")]),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1"},[n("span",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.handleEditStatusClick("PUBLISHED")}}},[t._v("通过")])]),n("a-menu-item",{key:"2"},[n("span",{attrs:{href:"javascript:void(0);"}},[t._v("通过并回复")])])],1)],1):"PUBLISHED"===t.comment.status?n("span",{on:{click:t.handleReplyClick}},[t._v("回复")]):"RECYCLE"===t.comment.status?n("a-popconfirm",{attrs:{title:"你确定要还原该评论？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick("PUBLISHED")}}},[n("span",[t._v("还原")])]):t._e(),"PUBLISHED"===t.comment.status||"AUDITING"===t.comment.status?n("a-popconfirm",{attrs:{title:"你确定要将该评论移到回收站？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick("RECYCLE")}}},[n("span",[t._v("回收站")])]):t._e(),n("a-popconfirm",{attrs:{title:"你确定要永久删除该评论？",okText:"确定",cancelText:"取消"},on:{confirm:t.handleDeleteClick}},[n("span",[t._v("删除")])])],1),n("a",{attrs:{slot:"author",href:t.comment.authorUrl,target:"_blank"},slot:"author"},[t.comment.isAdmin?n("a-icon",{staticStyle:{"margin-right":"3px"},attrs:{type:"user"}}):t._e(),t._v(" "+t._s(t.comment.author)+" ")],1),n("a-avatar",{attrs:{slot:"avatar",size:"large",src:t.avatar,alt:t.comment.author},slot:"avatar"}),n("p",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.content)},slot:"content"}),n("a-tooltip",{attrs:{slot:"datetime"},slot:"datetime"},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t._f("moment")(t.comment.createTime)))]),n("span",[t._v(t._s(t._f("timeAgo")(t.comment.createTime)))])]),t.comment.children?t._l(t.comment.children,(function(e,a){return n("TargetCommentTree",t._g(t._b({key:a,attrs:{comment:e},on:{reply:t.handleReplyClick,delete:t.handleDeleteClick,editStatus:t.handleEditStatusClick}},"TargetCommentTree",t.$attrs,!1),t.$listeners))})):t._e()],2)],1)},l=[],r=n("0e54"),c=n.n(r),u=n("ca00"),m={name:"TargetCommentTree",props:{comment:{type:Object,required:!1,default:null}},computed:{avatar:function(){return"//cn.gravatar.com/avatar/".concat(this.comment.gravatarMd5,"/?s=256&d=mp")},content:function(){return c()(Object(u["b"])(this.comment.content))}},methods:{handleReplyClick:function(){this.$emit("reply",this.comment)},handleEditStatusClick:function(t){this.$emit("editStatus",this.comment,t)},handleDeleteClick:function(){this.$emit("delete",this.comment)}}},d=m,h=n("2877"),p=Object(h["a"])(d,o,l,!1,null,null,null),f=p.exports,v=n("063c"),g={name:"TargetCommentDrawer",mixins:[s["a"],s["b"]],components:{TargetCommentTree:f},data:function(){return{comments:[],loading:!1,selectedComment:{},replyComment:{},replyCommentVisible:!1,commentVisible:!1,pagination:{page:1,size:10,sort:null,total:1},queryParam:{page:0,size:10,sort:null,keyword:null}}},props:{visible:{type:Boolean,required:!1,default:!1},title:{type:String,required:!1,default:""},description:{type:String,required:!1,default:""},target:{type:String,required:!1,default:""},id:{type:Number,required:!1,default:0}},methods:{handleListComments:function(){var t=this;this.loading=!0,this.queryParam.page=this.pagination.page-1,this.queryParam.size=this.pagination.size,this.queryParam.sort=this.pagination.sort,v["a"].commentTree(this.target,this.id,this.queryParam).then((function(e){t.comments=e.data.data.content,t.pagination.total=e.data.data.total})).finally((function(){setTimeout((function(){t.loading=!1}),200)}))},handlePaginationChange:function(t,e){this.pagination.page=t,this.pagination.size=e,this.handleListComments()},handleCommentReply:function(t){this.selectedComment=t,this.replyCommentVisible=!0,this.replyComment.parentId=t.id,this.replyComment.postId=this.id},handleComment:function(){this.replyComment.postId=this.id,this.commentVisible=!0},handleCreateClick:function(){var t=this;this.replyComment.content?v["a"].create(this.target,this.replyComment).then((function(e){t.$message.success("回复成功！"),t.replyComment={},t.selectedComment={},t.replyCommentVisible=!1,t.commentVisible=!1})).finally((function(){t.handleListComments()})):this.$notification["error"]({message:"提示",description:"评论内容不能为空！"})},handleEditStatusClick:function(t,e){var n=this;v["a"].updateStatus(this.target,t.id,e).then((function(t){n.$message.success("操作成功！")})).finally((function(){n.handleListComments()}))},handleCommentDelete:function(t){var e=this;v["a"].delete(this.target,t.id).then((function(t){e.$message.success("删除成功！")})).finally((function(){e.handleListComments()}))},onReplyClose:function(){this.replyComment={},this.selectedComment={},this.replyCommentVisible=!1},onCommentClose:function(){this.replyComment={},this.commentVisible=!1},onClose:function(){this.comments=[],this.pagination={page:1,size:10,sort:""},this.$emit("close",!1)},handleAfterVisibleChanged:function(t){t&&this.handleListComments()}}},C=g,y=Object(h["a"])(C,a,i,!1,null,null,null);e["a"]=y.exports},"1f27":function(t,e,n){"use strict";var a=n("9efd"),i="/api/admin/menus",s={listAll:function(){return Object(a["a"])({url:i,method:"get"})},listTree:function(){return Object(a["a"])({url:"".concat(i,"/tree_view"),method:"get"})},create:function(t){return Object(a["a"])({url:i,data:t,method:"post"})},delete:function(t){return Object(a["a"])({url:"".concat(i,"/").concat(t),method:"delete"})},get:function(t){return Object(a["a"])({url:"".concat(i,"/").concat(t),method:"get"})},update:function(t,e){return Object(a["a"])({url:"".concat(i,"/").concat(t),data:e,method:"put"})},listTeams:function(){return Object(a["a"])({url:"".concat(i,"/teams"),method:"get"})}};e["a"]=s},a8ed:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-row",[n("a-col",{attrs:{span:24}},[n("div",{staticClass:"card-container"},[n("a-tabs",{attrs:{type:"card"},model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},t._l(t.panes,(function(e){return n("a-tab-pane",{key:e.key},[n("span",{attrs:{slot:"tab"},slot:"tab"},[n("a-icon",{attrs:{type:e.icon}}),t._v(t._s(e.title)+" ")],1),n(e.component,{tag:"component"})],1)})),1)],1)])],1)],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isMobile()?n("a-list",{attrs:{itemLayout:"vertical",size:"large",pagination:!1,dataSource:t.independentSheets,loading:t.loading},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return n("a-list-item",{key:a},[n("template",{slot:"actions"},[n("span",[n("router-link",{attrs:{to:{name:e.routeName}}},[n("a-icon",{attrs:{type:"edit"}})],1)],1)]),n("template",{slot:"extra"},[e.available?n("span",[t._v("可用")]):n("span",[t._v("不可用 "),n("a-tooltip",{attrs:{slot:"action",title:"当前主题没有对应模板"},slot:"action"},[n("a-icon",{attrs:{type:"info-circle-o"}})],1)],1)]),n("a-list-item-meta",[n("span",{staticStyle:{"max-width":"300px",display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{slot:"title"},slot:"title"},[e.available?n("a",{attrs:{href:e.fullPath,target:"_blank"}},[t._v(t._s(e.title))]):n("a",{attrs:{href:e.fullPath,target:"_blank",disabled:""}},[t._v(t._s(e.title))])])])],2)}}],null,!1,3947683055)}):n("a-table",{attrs:{columns:t.independentColumns,dataSource:t.independentSheets,pagination:!1,rowKey:function(t){return t.id},loading:t.loading},scopedSlots:t._u([{key:"available",fn:function(e){return[e?n("span",[t._v("可用")]):n("span",[t._v("不可用 "),n("a-tooltip",{attrs:{slot:"action",title:"当前主题没有对应模板"},slot:"action"},[n("a-icon",{attrs:{type:"info-circle-o"}})],1)],1)]}},{key:"action",fn:function(e,a){return n("span",{},[n("router-link",{attrs:{to:{name:a.routeName}}},[n("a",{attrs:{href:"javascript:void(0);"}},[t._v("管理")])]),n("a-divider",{attrs:{type:"vertical"}}),a.available?n("a",{attrs:{href:a.fullPath,target:"_blank"}},[t._v("访问")]):n("a",{attrs:{href:a.fullPath,target:"_blank",disabled:""}},[t._v("访问")])],1)}}])})],1)},o=[],l=n("ac0d"),r=n("ed66"),c=[{title:"页面名称",dataIndex:"title"},{title:"访问地址",dataIndex:"fullPath"},{title:"状态",dataIndex:"available",scopedSlots:{customRender:"available"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],u={name:"IndependentSheetList",mixins:[l["a"],l["b"]],data:function(){return{independentColumns:c,independentSheets:[],loading:!1}},created:function(){this.loadIndependentSheets()},methods:{loadIndependentSheets:function(){var t=this;this.loading=!0,r["a"].listIndependent().then((function(e){t.independentSheets=e.data.data})).finally((function(){setTimeout((function(){t.loading=!1}),200)}))}}},m=u,d=n("2877"),h=Object(d["a"])(m,s,o,!1,null,null,null),p=h.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isMobile()?n("a-list",{attrs:{itemLayout:"vertical",size:"large",pagination:!1,dataSource:t.formattedSheets,loading:t.loading},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return n("a-list-item",{key:a},[n("template",{slot:"actions"},[n("span",[n("a-icon",{attrs:{type:"eye"}}),t._v(" "+t._s(e.visits)+" ")],1),n("span",{on:{click:function(n){return t.handleShowSheetComments(e)}}},[n("a-icon",{attrs:{type:"message"}}),t._v(" "+t._s(e.commentCount)+" ")],1),n("a-dropdown",{attrs:{placement:"topLeft",trigger:["click"]}},[n("span",[n("a-icon",{attrs:{type:"bars"}})],1),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},["PUBLISHED"===e.status||"DRAFT"===e.status?n("a-menu-item",[n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return t.handleEditClick(e)}}},[t._v("编辑")])]):"RECYCLE"===e.status?n("a-menu-item",[n("a-popconfirm",{attrs:{title:"你确定要发布【"+e.title+"】页面？",okText:"确定",cancelText:"取消"},on:{confirm:function(n){return t.handleEditStatusClick(e.id,"PUBLISHED")}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("还原")])])],1):t._e(),"PUBLISHED"===e.status||"DRAFT"===e.status?n("a-menu-item",[n("a-popconfirm",{attrs:{title:"你确定要将【"+e.title+"】页面移到回收站？",okText:"确定",cancelText:"取消"},on:{confirm:function(n){return t.handleEditStatusClick(e.id,"RECYCLE")}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("回收站")])])],1):"RECYCLE"===e.status?n("a-menu-item",[n("a-popconfirm",{attrs:{title:"你确定要永久删除【"+e.title+"】页面？",okText:"确定",cancelText:"取消"},on:{confirm:function(n){return t.handleDeleteClick(e.id)}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("删除")])])],1):t._e(),n("a-menu-item",[n("a-popconfirm",{attrs:{title:"你确定要添加【"+e.title+"】到菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(n){return t.handleSheetToMenu(e)}}},[n("a",{attrs:{href:"javascript:void(0);"}},[t._v("添加到菜单")])])],1),n("a-menu-item",[n("a",{attrs:{rel:"noopener noreferrer",href:"javascript:void(0);"},on:{click:function(n){return t.handleShowSheetSettings(e)}}},[t._v("设置")])])],1)],1)],1),n("template",{slot:"extra"},[n("span",[n("a-badge",{attrs:{status:e.statusProperty.status,text:e.statusProperty.text}})],1)]),n("a-list-item-meta",[n("template",{slot:"description"},[t._v(" "+t._s(t._f("moment")(e.createTime))+" ")]),n("span",{staticStyle:{"max-width":"300px",display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},attrs:{slot:"title"},slot:"title"},["PUBLISHED"==e.status?n("a",{staticClass:"no-underline",attrs:{href:e.fullPath,target:"_blank"}},[n("a-tooltip",{attrs:{placement:"top",title:"点击访问【"+e.title+"】"}},[t._v(t._s(e.title))])],1):"DRAFT"==e.status?n("a",{staticClass:"no-underline",attrs:{href:"javascript:void(0)"},on:{click:function(n){return t.handlePreview(e.id)}}},[n("a-tooltip",{attrs:{placement:"topLeft",title:"点击预览【"+e.title+"】"}},[t._v(t._s(e.title))])],1):n("a",{staticClass:"no-underline",attrs:{href:"javascript:void(0);",disabled:""}},[t._v(" "+t._s(e.title)+" ")])])],2),n("span",[t._v(" "+t._s(e.summary)+"... ")])],2)}}],null,!1,1817397998)}):n("a-table",{attrs:{rowKey:function(t){return t.id},columns:t.customColumns,dataSource:t.formattedSheets,pagination:!1,loading:t.loading,scrollToFirstRowOnChange:!0},scopedSlots:t._u([{key:"sheetTitle",fn:function(e,a){return n("span",{},["PUBLISHED"==a.status?n("a",{staticClass:"no-underline",attrs:{href:a.fullPath,target:"_blank"}},[n("a-tooltip",{attrs:{placement:"top",title:"点击访问【"+e+"】"}},[t._v(t._s(e))])],1):"DRAFT"==a.status?n("a",{staticClass:"no-underline",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.handlePreview(a.id)}}},[n("a-tooltip",{attrs:{placement:"topLeft",title:"点击预览【"+e+"】"}},[t._v(t._s(e))])],1):n("a",{staticClass:"no-underline",attrs:{href:"javascript:void(0);",disabled:""}},[t._v(" "+t._s(e)+" ")])])}},{key:"status",fn:function(t){return n("span",{},[n("a-badge",{attrs:{status:t.status,text:t.text}})],1)}},{key:"commentCount",fn:function(e,a){return n("span",{staticClass:"cursor-pointer",on:{click:function(e){return t.handleShowSheetComments(a)}}},[n("a-badge",{attrs:{count:a.commentCount,numberStyle:{backgroundColor:"#f38181"},showZero:!0,overflowCount:999}})],1)}},{key:"visits",fn:function(t){return n("span",{},[n("a-badge",{attrs:{count:t,numberStyle:{backgroundColor:"#00e0ff"},showZero:!0,overflowCount:9999}})],1)}},{key:"createTime",fn:function(e){return n("span",{},[n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[t._v(" "+t._s(t._f("moment")(e))+" ")]),t._v(" "+t._s(t._f("timeAgo")(e))+" ")],2)],1)}},{key:"action",fn:function(e,a){return n("span",{},["PUBLISHED"===a.status||"DRAFT"===a.status?n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditClick(a)}}},[t._v("编辑")]):"RECYCLE"===a.status?n("a-popconfirm",{attrs:{title:"你确定要发布【"+a.title+"】？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick(a.id,"PUBLISHED")}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("还原")])]):t._e(),n("a-divider",{attrs:{type:"vertical"}}),"PUBLISHED"===a.status||"DRAFT"===a.status?n("a-popconfirm",{attrs:{title:"你确定要将【"+a.title+"】页面移到回收站？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick(a.id,"RECYCLE")}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("回收站")])]):"RECYCLE"===a.status?n("a-popconfirm",{attrs:{title:"你确定要永久删除【"+a.title+"】页面？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleDeleteClick(a.id)}}},[n("a",{attrs:{href:"javascript:;"}},[t._v("删除")])]):t._e(),n("a-divider",{attrs:{type:"vertical"}}),n("a-dropdown",{attrs:{trigger:["click"]}},[n("a",{staticClass:"ant-dropdown-link",attrs:{href:"javascript:void(0);"}},[t._v("更多")]),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1"},[n("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.handleShowSheetSettings(a)}}},[t._v("设置")])]),n("a-menu-item",{key:"2"},[n("a-popconfirm",{attrs:{title:"你确定要添加【"+a.title+"】到菜单？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleSheetToMenu(a)}}},[n("a",{attrs:{href:"javascript:void(0);"}},[t._v("添加到菜单")])])],1)],1)],1)],1)}}])}),n("div",{staticClass:"page-wrapper"},[n("a-pagination",{staticClass:"pagination",attrs:{current:t.pagination.page,total:t.pagination.total,defaultPageSize:t.pagination.size,pageSizeOptions:["1","2","5","10","20","50","100"],showSizeChanger:"",showLessItems:""},on:{showSizeChange:t.handlePaginationChange,change:t.handlePaginationChange}})],1),n("SheetSettingDrawer",{attrs:{sheet:t.selectedSheet,metas:t.selectedMetas,visible:t.sheetSettingVisible,needTitle:!0,saveDraftButton:!1},on:{close:t.onSheetSettingsClose,onRefreshSheet:t.onRefreshSheetFromSetting,onRefreshSheetMetas:t.onRefreshSheetMetasFromSetting}}),n("TargetCommentDrawer",{attrs:{visible:t.sheetCommentVisible,title:t.selectedSheet.title,description:t.selectedSheet.summary,target:"sheets",id:t.selectedSheet.id},on:{close:t.onSheetCommentsClose}})],1)},v=[],g=(n("55dd"),n("2c5b")),C=n("066d"),y=n("1f27"),S=[{title:"标题",dataIndex:"title",ellipsis:!0,scopedSlots:{customRender:"sheetTitle"}},{title:"状态",className:"status",dataIndex:"statusProperty",scopedSlots:{customRender:"status"}},{title:"评论量",dataIndex:"commentCount",scopedSlots:{customRender:"commentCount"}},{title:"访问量",dataIndex:"visits",scopedSlots:{customRender:"visits"}},{title:"发布时间",dataIndex:"createTime",scopedSlots:{customRender:"createTime"}},{title:"操作",width:"180px",scopedSlots:{customRender:"action"}}],_={name:"CustomSheetList",mixins:[l["a"],l["b"]],components:{SheetSettingDrawer:g["a"],TargetCommentDrawer:C["a"]},data:function(){return{pagination:{page:1,size:10,sort:null,total:1},queryParam:{page:0,size:10,sort:null,keyword:null,categoryId:null,status:null},loading:!1,sheetStatus:r["a"].sheetStatus,customColumns:S,selectedSheet:{},selectedMetas:[],sheetSettingVisible:!1,sheetCommentVisible:!1,sheets:[],menu:{}}},computed:{formattedSheets:function(){var t=this;return this.sheets.map((function(e){return e.statusProperty=t.sheetStatus[e.status],e}))}},created:function(){this.handleListSheets()},destroyed:function(){this.sheetSettingVisible&&(this.sheetSettingVisible=!1)},beforeRouteLeave:function(t,e,n){this.sheetSettingVisible&&(this.sheetSettingVisible=!1),n()},methods:{handleListSheets:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.loading=!0),this.queryParam.page=this.pagination.page-1,this.queryParam.size=this.pagination.size,this.queryParam.sort=this.pagination.sort,r["a"].list(this.queryParam).then((function(e){t.sheets=e.data.data.content,t.pagination.total=e.data.data.total})).finally((function(){setTimeout((function(){t.loading=!1}),200)}))},handleEditClick:function(t){this.$router.push({name:"SheetEdit",query:{sheetId:t.id}})},handleEditStatusClick:function(t,e){var n=this;r["a"].updateStatus(t,e).then((function(t){n.$message.success("操作成功！")})).finally((function(){n.handleListSheets()}))},handleDeleteClick:function(t){var e=this;r["a"].delete(t).then((function(t){e.$message.success("删除成功！")})).finally((function(){e.handleListSheets()}))},handleSheetToMenu:function(t){var e=this;this.menu["name"]=t.title,this.menu["url"]="".concat(t.fullPath),y["a"].create(this.menu).then((function(t){e.$message.success("添加到菜单成功！"),e.menu={}}))},handleShowSheetSettings:function(t){var e=this;r["a"].get(t.id).then((function(t){e.selectedSheet=t.data.data,e.selectedMetas=e.selectedSheet.metas,e.sheetSettingVisible=!0}))},handleShowSheetComments:function(t){var e=this;r["a"].get(t.id).then((function(t){e.selectedSheet=t.data.data,e.sheetCommentVisible=!0}))},handlePreview:function(t){r["a"].preview(t).then((function(t){window.open(t.data,"_blank")}))},handlePaginationChange:function(t,e){this.$log.debug("Current: ".concat(t,", PageSize: ").concat(e)),this.pagination.page=t,this.pagination.size=e,this.handleListSheets()},onSheetSettingsClose:function(){var t=this;this.sheetSettingVisible=!1,this.selectedSheet={},setTimeout((function(){t.handleListSheets(!1)}),500)},onSheetCommentsClose:function(){var t=this;this.sheetCommentVisible=!1,this.selectedSheet={},setTimeout((function(){t.handleListSheets(!1)}),500)},onRefreshSheetFromSetting:function(t){this.selectedSheet=t},onRefreshSheetMetasFromSetting:function(t){this.selectedMetas=t}}},b=_,k=Object(d["a"])(b,f,v,!1,null,null,null),T=k.exports,w={data:function(){var t=[{title:"独立页面",icon:"paper-clip",component:"IndependentSheetList",key:"independent"},{title:"自定义页面",icon:"fork",component:"CustomSheetList",key:"custom"}];return{activeKey:t[0].key,panes:t}},beforeRouteEnter:function(t,e,n){var a=t.query.activeKey;n((function(t){a&&(t.activeKey=a)}))},watch:{activeKey:{handler:function(t,e){if(t){var n=this.$router.history.current.path;this.$router.push({path:n,query:{activeKey:t}}).catch((function(t){return t}))}}}},components:{IndependentSheetList:p,CustomSheetList:T}},x=w,E=Object(d["a"])(x,a,i,!1,null,null,null);e["default"]=E.exports}}]);